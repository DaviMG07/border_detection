#! /usr/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/system.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_sys.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_textio.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/v2005_math.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/va_math.vpi";
S_0x55de984261a0 .scope module, "mac_tb" "mac_tb" 2 2;
 .timescale -9 -12;
v0x55de9844cfa0_0 .var "clear", 0 0;
v0x55de9844d060_0 .var "clock", 0 0;
v0x55de9844d100_0 .net "done", 0 0, v0x55de9844c9c0_0;  1 drivers
v0x55de9844d1d0_0 .var "enable", 0 0;
v0x55de9844d2a0_0 .var "expected_result", 7 0;
v0x55de9844d340_0 .net "result", 7 0, L_0x55de9845de70;  1 drivers
v0x55de9844d3e0_0 .var "value_a", 7 0;
v0x55de9844d4b0_0 .var/s "value_b", 7 0;
S_0x55de98426330 .scope module, "uut" "mac" 2 11, 3 1 0, S_0x55de984261a0;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clock";
    .port_info 1 /INPUT 1 "clear";
    .port_info 2 /INPUT 1 "enable";
    .port_info 3 /INPUT 8 "value_a";
    .port_info 4 /INPUT 8 "value_b";
    .port_info 5 /OUTPUT 8 "result";
    .port_info 6 /OUTPUT 1 "done";
v0x55de9841ca10_0 .net/s *"_ivl_0", 15 0, L_0x55de9844d580;  1 drivers
L_0x7f628f043060 .functor BUFT 1, C4<11111111>, C4<0>, C4<0>, C4<0>;
v0x55de9844bf90_0 .net/2u *"_ivl_10", 7 0, L_0x7f628f043060;  1 drivers
L_0x7f628f0430a8 .functor BUFT 1, C4<0000000000000000000000000000000000000000>, C4<0>, C4<0>, C4<0>;
v0x55de9844c070_0 .net/2s *"_ivl_12", 39 0, L_0x7f628f0430a8;  1 drivers
v0x55de9844c130_0 .net *"_ivl_14", 0 0, L_0x55de9845da90;  1 drivers
L_0x7f628f0430f0 .functor BUFT 1, C4<00000000>, C4<0>, C4<0>, C4<0>;
v0x55de9844c1f0_0 .net/2u *"_ivl_16", 7 0, L_0x7f628f0430f0;  1 drivers
v0x55de9844c320_0 .net *"_ivl_19", 7 0, L_0x55de9845dc00;  1 drivers
v0x55de9844c400_0 .net/s *"_ivl_2", 15 0, L_0x55de9844d6a0;  1 drivers
v0x55de9844c4e0_0 .net *"_ivl_20", 7 0, L_0x55de9845dce0;  1 drivers
L_0x7f628f043018 .functor BUFT 1, C4<0000000000000000000000000000000011111111>, C4<0>, C4<0>, C4<0>;
v0x55de9844c5c0_0 .net/2s *"_ivl_6", 39 0, L_0x7f628f043018;  1 drivers
v0x55de9844c6a0_0 .net *"_ivl_8", 0 0, L_0x55de9845d8e0;  1 drivers
v0x55de9844c760_0 .var/s "accumulator", 39 0;
v0x55de9844c840_0 .net "clear", 0 0, v0x55de9844cfa0_0;  1 drivers
v0x55de9844c900_0 .net "clock", 0 0, v0x55de9844d060_0;  1 drivers
v0x55de9844c9c0_0 .var "done", 0 0;
v0x55de9844ca80_0 .net "enable", 0 0, v0x55de9844d1d0_0;  1 drivers
v0x55de9844cb40_0 .net/s "product", 15 0, L_0x55de9844d790;  1 drivers
v0x55de9844cc20_0 .net "result", 7 0, L_0x55de9845de70;  alias, 1 drivers
v0x55de9844cd00_0 .net "value_a", 7 0, v0x55de9844d3e0_0;  1 drivers
v0x55de9844cde0_0 .net/s "value_b", 7 0, v0x55de9844d4b0_0;  1 drivers
E_0x55de98422b00 .event posedge, v0x55de9844c900_0;
L_0x55de9844d580 .extend/s 16, v0x55de9844d3e0_0;
L_0x55de9844d6a0 .extend/s 16, v0x55de9844d4b0_0;
L_0x55de9844d790 .arith/mult 16, L_0x55de9844d580, L_0x55de9844d6a0;
L_0x55de9845d8e0 .cmp/gt.s 40, v0x55de9844c760_0, L_0x7f628f043018;
L_0x55de9845da90 .cmp/gt.s 40, L_0x7f628f0430a8, v0x55de9844c760_0;
L_0x55de9845dc00 .part v0x55de9844c760_0, 0, 8;
L_0x55de9845dce0 .functor MUXZ 8, L_0x55de9845dc00, L_0x7f628f0430f0, L_0x55de9845da90, C4<>;
L_0x55de9845de70 .functor MUXZ 8, L_0x55de9845dce0, L_0x7f628f043060, L_0x55de9845d8e0, C4<>;
    .scope S_0x55de98426330;
T_0 ;
    %wait E_0x55de98422b00;
    %load/vec4 v0x55de9844c840_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_0.0, 8;
    %pushi/vec4 0, 0, 40;
    %assign/vec4 v0x55de9844c760_0, 0;
    %jmp T_0.1;
T_0.0 ;
    %load/vec4 v0x55de9844ca80_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_0.2, 8;
    %load/vec4 v0x55de9844c760_0;
    %load/vec4 v0x55de9844cb40_0;
    %pad/s 40;
    %add;
    %assign/vec4 v0x55de9844c760_0, 0;
T_0.2 ;
T_0.1 ;
    %jmp T_0;
    .thread T_0;
    .scope S_0x55de98426330;
T_1 ;
    %wait E_0x55de98422b00;
    %load/vec4 v0x55de9844c840_0;
    %flag_set/vec4 8;
    %jmp/1 T_1.2, 8;
    %load/vec4 v0x55de9844ca80_0;
    %flag_set/vec4 9;
    %flag_or 8, 9;
T_1.2;
    %jmp/0xz  T_1.0, 8;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v0x55de9844c9c0_0, 0;
    %jmp T_1.1;
T_1.0 ;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x55de9844c9c0_0, 0;
T_1.1 ;
    %jmp T_1;
    .thread T_1;
    .scope S_0x55de984261a0;
T_2 ;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844d060_0, 0, 1;
T_2.0 ;
    %delay 5000, 0;
    %load/vec4 v0x55de9844d060_0;
    %inv;
    %store/vec4 v0x55de9844d060_0, 0, 1;
    %jmp T_2.0;
    %end;
    .thread T_2;
    .scope S_0x55de984261a0;
T_3 ;
    %vpi_call 2 25 "$display", "--- Starting MAC Testbench (Corrected Types) ---" {0 0 0};
    %vpi_call 2 26 "$monitor", "Time=%0t: clear=%b, enable=%b, value_a=%d, value_b=%d -> result=%d, done=%b", $time, v0x55de9844cfa0_0, v0x55de9844d1d0_0, v0x55de9844d3e0_0, v0x55de9844d4b0_0, v0x55de9844d340_0, v0x55de9844d100_0 {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %vpi_call 2 29 "$display", "\012--- Test 1: Simple Multiplication ---" {0 0 0};
    %pushi/vec4 10, 0, 8;
    %store/vec4 v0x55de9844d3e0_0, 0, 8;
    %pushi/vec4 5, 0, 8;
    %store/vec4 v0x55de9844d4b0_0, 0, 8;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %pushi/vec4 50, 0, 8;
    %store/vec4 v0x55de9844d2a0_0, 0, 8;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %load/vec4 v0x55de9844d340_0;
    %load/vec4 v0x55de9844d2a0_0;
    %cmp/ne;
    %jmp/0xz  T_3.0, 6;
    %vpi_call 2 33 "$display", "*** TEST 1 FAILED: Result=%d, Expected=%d ***", v0x55de9844d340_0, v0x55de9844d2a0_0 {0 0 0};
    %jmp T_3.1;
T_3.0 ;
    %vpi_call 2 34 "$display", "--- TEST 1 PASSED ---" {0 0 0};
T_3.1 ;
    %delay 10000, 0;
    %vpi_call 2 36 "$display", "\012--- Test 2: Saturation (Positive) ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 100, 0, 8;
    %store/vec4 v0x55de9844d3e0_0, 0, 8;
    %pushi/vec4 3, 0, 8;
    %store/vec4 v0x55de9844d4b0_0, 0, 8;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %pushi/vec4 255, 0, 8;
    %store/vec4 v0x55de9844d2a0_0, 0, 8;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %load/vec4 v0x55de9844d340_0;
    %load/vec4 v0x55de9844d2a0_0;
    %cmp/ne;
    %jmp/0xz  T_3.2, 6;
    %vpi_call 2 41 "$display", "*** TEST 2 FAILED: Result=%d, Expected=%d ***", v0x55de9844d340_0, v0x55de9844d2a0_0 {0 0 0};
    %jmp T_3.3;
T_3.2 ;
    %vpi_call 2 42 "$display", "--- TEST 2 PASSED ---" {0 0 0};
T_3.3 ;
    %delay 10000, 0;
    %vpi_call 2 44 "$display", "\012--- Test 3: Saturation (Negative) ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 10, 0, 8;
    %store/vec4 v0x55de9844d3e0_0, 0, 8;
    %pushi/vec4 254, 0, 8;
    %store/vec4 v0x55de9844d4b0_0, 0, 8;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %pushi/vec4 0, 0, 8;
    %store/vec4 v0x55de9844d2a0_0, 0, 8;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %load/vec4 v0x55de9844d340_0;
    %load/vec4 v0x55de9844d2a0_0;
    %cmp/ne;
    %jmp/0xz  T_3.4, 6;
    %vpi_call 2 49 "$display", "*** TEST 3 FAILED: Result=%d, Expected=%d ***", v0x55de9844d340_0, v0x55de9844d2a0_0 {0 0 0};
    %jmp T_3.5;
T_3.4 ;
    %vpi_call 2 50 "$display", "--- TEST 3 PASSED ---" {0 0 0};
T_3.5 ;
    %delay 10000, 0;
    %vpi_call 2 52 "$display", "\012--- Test 4: Accumulation ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844cfa0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 10, 0, 8;
    %store/vec4 v0x55de9844d3e0_0, 0, 8;
    %pushi/vec4 2, 0, 8;
    %store/vec4 v0x55de9844d4b0_0, 0, 8;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %delay 10000, 0;
    %pushi/vec4 5, 0, 8;
    %store/vec4 v0x55de9844d3e0_0, 0, 8;
    %pushi/vec4 3, 0, 8;
    %store/vec4 v0x55de9844d4b0_0, 0, 8;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %pushi/vec4 35, 0, 8;
    %store/vec4 v0x55de9844d2a0_0, 0, 8;
    %delay 10000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x55de9844d1d0_0, 0, 1;
    %load/vec4 v0x55de9844d340_0;
    %load/vec4 v0x55de9844d2a0_0;
    %cmp/ne;
    %jmp/0xz  T_3.6, 6;
    %vpi_call 2 58 "$display", "*** TEST 4 FAILED: Result=%d, Expected=%d ***", v0x55de9844d340_0, v0x55de9844d2a0_0 {0 0 0};
    %jmp T_3.7;
T_3.6 ;
    %vpi_call 2 59 "$display", "--- TEST 4 PASSED ---" {0 0 0};
T_3.7 ;
    %vpi_call 2 60 "$display", "\012--- MAC Testbench Finished ---" {0 0 0};
    %vpi_call 2 61 "$finish" {0 0 0};
    %end;
    .thread T_3;
# The file index is used to find the file name in the following table.
:file_names 4;
    "N/A";
    "<interactive>";
    "tests/mac_tb.v";
    "src/mac.v";
